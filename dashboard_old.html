<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BIP AI Sprint Cycle Time Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<style>
  :root {
    --bg: #0f172a; --card: #1e293b; --border: #334155; --text: #e2e8f0;
    --muted: #94a3b8; --accent: #3b82f6; --green: #22c55e; --yellow: #eab308;
    --red: #ef4444; --purple: #a855f7; --orange: #f97316; --cyan: #06b6d4;
    --pink: #ec4899;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg); color: var(--text); padding: 24px; }
  h1 { font-size: 28px; font-weight: 700; margin-bottom: 4px; }
  .subtitle { color: var(--muted); font-size: 14px; margin-bottom: 24px; }
  .grid { display: grid; gap: 20px; margin-bottom: 20px; }
  .grid-4 { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); }
  .grid-2 { grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); }
  .grid-3 { grid-template-columns: repeat(auto-fit, minmax(340px, 1fr)); }
  .card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; }
  .card h3 { font-size: 13px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; }
  .card .big { font-size: 36px; font-weight: 700; }
  .card .detail { font-size: 13px; color: var(--muted); margin-top: 4px; }
  .card .trend-up { color: var(--green); } .card .trend-down { color: var(--red); }
  .chart-card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; margin-bottom: 20px; }
  .chart-card h2 { font-size: 18px; font-weight: 600; margin-bottom: 16px; }
  .chart-card .chart-desc { font-size: 13px; color: var(--muted); margin-bottom: 12px; }
  canvas { max-height: 400px; }
  .insights { background: linear-gradient(135deg, #1e3a5f, #1e293b); border: 1px solid var(--accent); border-radius: 12px; padding: 24px; margin-bottom: 20px; }
  .insights h2 { font-size: 20px; margin-bottom: 16px; color: var(--accent); }
  .insights ul { list-style: none; padding: 0; }
  .insights li { padding: 10px 0; border-bottom: 1px solid var(--border); font-size: 14px; line-height: 1.6; }
  .insights li:last-child { border-bottom: none; }
  .insights .tag { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; margin-right: 8px; }
  .tag-positive { background: rgba(34,197,94,0.2); color: var(--green); }
  .tag-warning { background: rgba(234,179,8,0.2); color: var(--yellow); }
  .tag-negative { background: rgba(239,68,68,0.2); color: var(--red); }
  .tag-info { background: rgba(59,130,246,0.2); color: var(--accent); }
  .quarter-cards { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 20px; }
  .quarter-card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; text-align: center; }
  .quarter-card h3 { font-size: 16px; margin-bottom: 12px; color: var(--accent); }
  .quarter-card .stat { display: flex; justify-content: space-between; padding: 6px 0; font-size: 14px; }
  .quarter-card .stat-value { font-weight: 600; }
  table { width: 100%; border-collapse: collapse; font-size: 13px; }
  th, td { padding: 10px 12px; text-align: left; border-bottom: 1px solid var(--border); }
  th { color: var(--muted); font-weight: 600; text-transform: uppercase; font-size: 11px; letter-spacing: 0.5px; }
  .status-bar { display: flex; height: 24px; border-radius: 6px; overflow: hidden; margin: 4px 0; }
  .status-bar div { display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 600; color: white; min-width: 2px; }
  footer { text-align: center; color: var(--muted); font-size: 12px; padding: 20px 0; }
</style>
</head>
<body>

<h1>BIP AI Sprint Delivery Dashboard</h1>
<p class="subtitle">Cycle Time Analysis &bull; 17 Sprints &bull; FY25 Q4 &ndash; FY26 Q2 &bull; 1,092 Issues</p>

<!-- KPI Cards -->
<div class="grid grid-4">
  <div class="card">
    <h3>Total Issues</h3>
    <div class="big">1,092</div>
    <div class="detail">Across 17 sprints (3 quarters)</div>
  </div>
  <div class="card">
    <h3>Completion Rate</h3>
    <div class="big" style="color: var(--green)">99.7%</div>
    <div class="detail">1,092 of 1,095 issues done</div>
  </div>
  <div class="card">
    <h3>Avg Cycle Time (Latest Q)</h3>
    <div class="big" style="color: var(--cyan)">12.4d</div>
    <div class="detail"><span class="trend-up">&#9660; 43% improvement</span> vs FY25 Q4 (21.9d)</div>
  </div>
  <div class="card">
    <h3>Backlog Wait Time</h3>
    <div class="big" style="color: var(--yellow)">52%</div>
    <div class="detail">Avg 16.5 days in Backlog (of total lifecycle)</div>
  </div>
</div>

<!-- Insights -->
<div class="insights">
  <h2>&#128161; Key Delivery Insights</h2>
  <ul>
    <li><span class="tag tag-positive">STRONG</span><strong>Cycle time improving quarter-over-quarter.</strong> Average cycle time dropped from 21.9 days (FY25 Q4) → 15.9 days (FY26 Q1) → 12.4 days (FY26 Q2). That's a <strong>43% reduction</strong> over ~7 months — a significant and sustained improvement in delivery speed.</li>
    <li><span class="tag tag-positive">STRONG</span><strong>Near-perfect completion rates.</strong> 99.7% of all issues reached Done status. From FY25Q4.4 onward, every sprint achieved 100% completion. The team consistently delivers on sprint commitments.</li>
    <li><span class="tag tag-warning">WATCH</span><strong>Backlog time dominates the lifecycle.</strong> Issues spend an average of <strong>52% of their total lifecycle sitting in Backlog</strong> (~16.5 days). This "wait time before work begins" is the single largest opportunity for cycle time reduction. Consider right-sizing sprint backlogs or pulling work just-in-time.</li>
    <li><span class="tag tag-warning">WATCH</span><strong>In Progress time is highly variable.</strong> While the median active development time is 4.5 days, the average is 17.4 days — suggesting a small number of issues drag on far longer than expected. These outliers pull up the team average and may benefit from WIP limits or earlier scope splitting.</li>
    <li><span class="tag tag-info">TREND</span><strong>Team tag "it_ai" dropped off after FY26Q1.2.</strong> This label was applied to nearly all issues in FY25 Q4 (53–70 per sprint) but fell to 0–4 from FY26Q1.3 onward. This likely reflects a labeling practice change rather than a team departure.</li>
    <li><span class="tag tag-info">TREND</span><strong>MLOps_Eng is the dominant workstream.</strong> MLOps_Eng carries 37–55 issues per sprint (60–75% of work), while Infra_Cloud handles 13–24 and BIPAI_Tenant fluctuates from 0–28. The team's delivery velocity is strongly tied to MLOps capacity.</li>
    <li><span class="tag tag-negative">RISK</span><strong>Issues frequently revisit earlier statuses.</strong> Multiple sampled issues showed 2–3 visits to "In Progress" and "Backlog," indicating rework loops. Issues like BIP-30311 visited Backlog 3 times and In Progress 3 times before completion. Reducing these loops could further cut cycle time.</li>
    <li><span class="tag tag-positive">EFFICIENCY</span><strong>Testing & review are fast.</strong> In Testing averages 1.6 days and Peer Review averages 1.7 days. These downstream stages are not bottlenecks — the team reviews and validates quickly once code is ready.</li>
  </ul>
</div>

<!-- Quarter Comparison -->
<div class="quarter-cards">
  <div class="quarter-card">
    <h3>FY25 Q4</h3>
    <div class="stat"><span>Issues</span><span class="stat-value">455</span></div>
    <div class="stat"><span>Done</span><span class="stat-value">452 (99.3%)</span></div>
    <div class="stat"><span>Avg Cycle Time</span><span class="stat-value">21.9 days</span></div>
    <div class="stat"><span>Sprints</span><span class="stat-value">7</span></div>
  </div>
  <div class="quarter-card">
    <h3>FY26 Q1</h3>
    <div class="stat"><span>Issues</span><span class="stat-value">447</span></div>
    <div class="stat"><span>Done</span><span class="stat-value">447 (100%)</span></div>
    <div class="stat"><span>Avg Cycle Time</span><span class="stat-value">15.9 days</span></div>
    <div class="stat"><span>Sprints</span><span class="stat-value">7</span></div>
  </div>
  <div class="quarter-card">
    <h3>FY26 Q2</h3>
    <div class="stat"><span>Issues</span><span class="stat-value">193</span></div>
    <div class="stat"><span>Done</span><span class="stat-value">193 (100%)</span></div>
    <div class="stat"><span>Avg Cycle Time</span><span class="stat-value">12.4 days</span></div>
    <div class="stat"><span>Sprints</span><span class="stat-value">3</span></div>
  </div>
</div>

<!-- Charts -->
<div class="grid grid-2">
  <div class="chart-card">
    <h2>Cycle Time Trend</h2>
    <p class="chart-desc">Average, median, and 85th percentile cycle time across sprints (days)</p>
    <canvas id="cycleTimeChart"></canvas>
  </div>
  <div class="chart-card">
    <h2>Sprint Throughput</h2>
    <p class="chart-desc">Total issues and completed issues per sprint</p>
    <canvas id="throughputChart"></canvas>
  </div>
</div>

<div class="grid grid-2">
  <div class="chart-card">
    <h2>Average Time in Each Status</h2>
    <p class="chart-desc">Based on detailed status history analysis of representative issues</p>
    <canvas id="statusDurationChart"></canvas>
  </div>
  <div class="chart-card">
    <h2>Lifecycle Time Distribution</h2>
    <p class="chart-desc">Percentage of total issue lifecycle spent in each status</p>
    <canvas id="statusPctChart"></canvas>
  </div>
</div>

<div class="grid grid-2">
  <div class="chart-card">
    <h2>Team Workload by Sprint</h2>
    <p class="chart-desc">Issue count by team label per sprint</p>
    <canvas id="teamChart"></canvas>
  </div>
  <div class="chart-card">
    <h2>Top Contributors</h2>
    <p class="chart-desc">Issues completed (across all sprints, Done status)</p>
    <canvas id="contributorChart"></canvas>
  </div>
</div>

<div class="chart-card">
  <h2>Status Distribution by Sprint</h2>
  <p class="chart-desc">Current status breakdown across all issues in each sprint</p>
  <canvas id="statusDistChart" style="max-height: 450px;"></canvas>
</div>

<!-- Sprint Detail Table -->
<div class="chart-card">
  <h2>Sprint Detail Table</h2>
  <table id="sprintTable">
    <thead>
      <tr>
        <th>Sprint</th>
        <th>Total</th>
        <th>Done</th>
        <th>Rate</th>
        <th>Avg CT</th>
        <th>Median CT</th>
        <th>P85 CT</th>
        <th>Status Mix</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<footer>BIP AI Delivery Dashboard &bull; Data from Jira &bull; Generated <span id="genDate"></span></footer>

<script>
// === DATA ===
const sprintLabels = ["FY25Q4.1","FY25Q4.2","FY25Q4.3","FY25Q4.4","FY25Q4.5","FY25Q4.6","FY25Q4.7","FY26Q1.1","FY26Q1.2","FY26Q1.3","FY26Q1.4","FY26Q1.5","FY26Q1.6","FY26Q1.7","FY26Q2.1","FY26Q2.2","FY26Q2.3"];
const totalIssues = [63,61,76,69,70,63,53,66,62,70,62,70,61,56,61,67,65];
const doneCount   = [62,60,75,69,70,63,53,66,62,70,62,70,61,56,61,67,65];
const avgCT       = [25.5,20.4,28.9,20.8,22.5,16.5,16.2,16.4,16.2,15.9,13.7,17.2,15.1,16.4,12.9,12.4,11.9];
const medianCT    = [14.0,14.5,15.0,15.0,15.2,14.9,14.9,14.2,14.4,14.0,12.2,16.7,13.9,17.9,13.8,14.1,13.3];
const p85CT       = [73.9,28.1,53.2,29.0,42.0,27.8,15.0,14.4,15.0,19.8,19.1,19.7,27.8,18.2,14.9,14.3,14.3];
const completionRate = [98.4,98.4,98.7,100,100,100,100,100,100,100,100,100,100,100,100,100,100];

const statusDistribution = [
  {"Done":62,"In Progress":1},
  {"Done":60,"In Testing":1},
  {"Done":75,"Backlog":1},
  {"Done":69},
  {"Done":70},
  {"Done":63},
  {"Done":53},
  {"Done":66},
  {"Done":62},
  {"Done":70},
  {"Done":62},
  {"Done":70},
  {"Done":61},
  {"Done":56},
  {"Done":61},
  {"Done":67},
  {"Done":65},
];

// Status duration data (from Jira issue_dates)
const statusDurations = {
  "Backlog":           { avgDays: 16.5, medianDays: 15.0, avgPct: 52.2 },
  "In Progress":       { avgDays: 17.4, medianDays: 4.5,  avgPct: 29.4 },
  "In Testing":        { avgDays: 1.6,  medianDays: 0.8,  avgPct: 11.8 },
  "Peer Review Needed":{ avgDays: 1.7,  medianDays: 1.0,  avgPct: 6.7  },
  "Blocked":           { avgDays: 4.7,  medianDays: 3.0,  avgPct: 15.7 }
};

const teamBreakdown = {
  "MLOps_Eng":    [46,47,55,53,52,43,40,46,43,46,49,50,41,37,37,46,47],
  "Infra_Cloud":  [16,14,20,16,18,22,13,19,19,24,13,18,19,17,24,20,17],
  "BIPAI_Tenant": [1,10,17,22,13,26,18,18,19,21,28,19,13,10,11,14,0],
  "Untagged":     [2,1,2,0,0,1,0,0,0,0,0,0,0,0,0,0,0],
};

const topContributors = [
  ["Jared Ross",68],["Seth Hill",67],["Carter Burns",66],["Jason Droz",61],
  ["Jorge Martinez",60],["James Plager",59],["Mark Zhang",59],["Lila Zapata",59],
  ["Qiao Chen",56],["Harmit Singh",55],["Julia Young",52],["Elise Hooker",49],
  ["Odniel Gonzalez Ortiz",44],["Vedant Prasad",42],["Anthony Tran",39],
  ["Youssef El Alamy",39],["Erik Holmberg",32],["Kurt Stohrer",29],
  ["Stefan Znam",25],["Jee Vang",21]
];

// === CHART DEFAULTS ===
Chart.defaults.color = '#94a3b8';
Chart.defaults.borderColor = '#334155';
Chart.defaults.font.family = "-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif";

const STATUS_COLORS = {
  'Backlog': '#64748b',
  'In Progress': '#3b82f6',
  'In Testing': '#06b6d4',
  'Peer Review Needed': '#a855f7',
  'Blocked': '#ef4444',
  'Done': '#22c55e',
  'Ready for Dev': '#eab308',
  'Unknown': '#475569',
};

const TEAM_COLORS = {
  'MLOps_Eng': '#3b82f6',
  'Infra_Cloud': '#06b6d4',
  'BIPAI_Tenant': '#a855f7',
  'it_ai': '#f97316',
  'Untagged': '#64748b',
};

// === CHARTS ===

// 1. Cycle Time Trend
new Chart(document.getElementById('cycleTimeChart'), {
  type: 'line',
  data: {
    labels: sprintLabels,
    datasets: [
      {
        label: 'Average',
        data: avgCT,
        borderColor: '#3b82f6',
        backgroundColor: 'rgba(59,130,246,0.1)',
        fill: true,
        tension: 0.3,
        pointRadius: 4,
        pointHoverRadius: 6,
        borderWidth: 2,
      },
      {
        label: 'Median',
        data: medianCT,
        borderColor: '#22c55e',
        backgroundColor: 'rgba(34,197,94,0.05)',
        fill: false,
        tension: 0.3,
        pointRadius: 3,
        borderWidth: 2,
        borderDash: [5,5],
      },
      {
        label: 'P85',
        data: p85CT,
        borderColor: '#f97316',
        backgroundColor: 'rgba(249,115,22,0.05)',
        fill: false,
        tension: 0.3,
        pointRadius: 3,
        borderWidth: 2,
        borderDash: [2,4],
      },
    ]
  },
  options: {
    responsive: true,
    plugins: {
      legend: { position: 'top' },
      tooltip: { callbacks: { label: ctx => `${ctx.dataset.label}: ${ctx.parsed.y} days` } }
    },
    scales: {
      y: { title: { display: true, text: 'Days' }, beginAtZero: true },
      x: { ticks: { maxRotation: 45 } }
    }
  }
});

// 2. Sprint Throughput
new Chart(document.getElementById('throughputChart'), {
  type: 'bar',
  data: {
    labels: sprintLabels,
    datasets: [
      {
        label: 'Total Issues',
        data: totalIssues,
        backgroundColor: 'rgba(100,116,139,0.5)',
        borderColor: '#64748b',
        borderWidth: 1,
      },
      {
        label: 'Completed',
        data: doneCount,
        backgroundColor: 'rgba(34,197,94,0.6)',
        borderColor: '#22c55e',
        borderWidth: 1,
      }
    ]
  },
  options: {
    responsive: true,
    plugins: { legend: { position: 'top' } },
    scales: {
      y: { title: { display: true, text: 'Issue Count' }, beginAtZero: true },
      x: { ticks: { maxRotation: 45 } }
    }
  }
});

// 3. Status Duration Bar Chart
const sdLabels = Object.keys(statusDurations);
const sdAvg = sdLabels.map(s => statusDurations[s].avgDays);
const sdMedian = sdLabels.map(s => statusDurations[s].medianDays);

new Chart(document.getElementById('statusDurationChart'), {
  type: 'bar',
  data: {
    labels: sdLabels,
    datasets: [
      {
        label: 'Average (days)',
        data: sdAvg,
        backgroundColor: sdLabels.map(s => STATUS_COLORS[s] || '#475569'),
        borderWidth: 0,
        borderRadius: 4,
      },
      {
        label: 'Median (days)',
        data: sdMedian,
        backgroundColor: sdLabels.map(s => {
          const c = STATUS_COLORS[s] || '#475569';
          return c + '80';
        }),
        borderWidth: 0,
        borderRadius: 4,
      }
    ]
  },
  options: {
    responsive: true,
    plugins: { legend: { position: 'top' } },
    scales: {
      y: { title: { display: true, text: 'Days' }, beginAtZero: true },
    }
  }
});

// 4. Status Percentage Doughnut
new Chart(document.getElementById('statusPctChart'), {
  type: 'doughnut',
  data: {
    labels: sdLabels,
    datasets: [{
      data: sdLabels.map(s => statusDurations[s].avgPct),
      backgroundColor: sdLabels.map(s => STATUS_COLORS[s] || '#475569'),
      borderWidth: 2,
      borderColor: '#1e293b',
    }]
  },
  options: {
    responsive: true,
    plugins: {
      legend: { position: 'right' },
      tooltip: { callbacks: { label: ctx => `${ctx.label}: ${ctx.parsed}% of lifecycle` } }
    }
  }
});

// 5. Team Workload
new Chart(document.getElementById('teamChart'), {
  type: 'bar',
  data: {
    labels: sprintLabels,
    datasets: Object.keys(teamBreakdown).map(team => ({
      label: team,
      data: teamBreakdown[team],
      backgroundColor: TEAM_COLORS[team] || '#475569',
      borderWidth: 0,
      borderRadius: 2,
    }))
  },
  options: {
    responsive: true,
    plugins: { legend: { position: 'top' } },
    scales: {
      x: { stacked: true, ticks: { maxRotation: 45 } },
      y: { stacked: true, title: { display: true, text: 'Issue Count' }, beginAtZero: true },
    }
  }
});

// 6. Top Contributors
const contribNames = topContributors.map(c => c[0]);
const contribValues = topContributors.map(c => c[1]);
const contribColors = contribValues.map((v,i) => {
  const hue = (i / contribNames.length) * 240 + 200;
  return `hsl(${hue % 360}, 60%, 55%)`;
});

new Chart(document.getElementById('contributorChart'), {
  type: 'bar',
  data: {
    labels: contribNames,
    datasets: [{
      label: 'Issues Completed',
      data: contribValues,
      backgroundColor: contribColors,
      borderWidth: 0,
      borderRadius: 4,
    }]
  },
  options: {
    responsive: true,
    indexAxis: 'y',
    plugins: { legend: { display: false } },
    scales: {
      x: { title: { display: true, text: 'Issues Completed' }, beginAtZero: true },
    }
  }
});

// 7. Status Distribution Stacked
const allStatuses = ['Done', 'In Progress', 'In Testing', 'Peer Review Needed', 'Backlog', 'Blocked', 'Ready for Dev'];
const statusDatasets = allStatuses.filter(s => {
  return statusDistribution.some(sd => (sd[s] || 0) > 0);
}).map(status => ({
  label: status,
  data: statusDistribution.map(sd => sd[status] || 0),
  backgroundColor: STATUS_COLORS[status] || '#475569',
  borderWidth: 0,
}));

new Chart(document.getElementById('statusDistChart'), {
  type: 'bar',
  data: {
    labels: sprintLabels,
    datasets: statusDatasets,
  },
  options: {
    responsive: true,
    plugins: { legend: { position: 'top' } },
    scales: {
      x: { stacked: true, ticks: { maxRotation: 45 } },
      y: { stacked: true, title: { display: true, text: 'Issue Count' }, beginAtZero: true },
    }
  }
});

// === Sprint Detail Table ===
const tbody = document.querySelector('#sprintTable tbody');
for (let i = 0; i < sprintLabels.length; i++) {
  const tr = document.createElement('tr');
  const rate = completionRate[i];
  const rateColor = rate === 100 ? 'var(--green)' : rate >= 95 ? 'var(--yellow)' : 'var(--red)';
  
  // Status bar
  const total = totalIssues[i];
  const done = doneCount[i];
  const inProg = totalIssues[i] - doneCount[i];
  const donePct = (done/total*100).toFixed(0);
  const ipPct = (inProg/total*100).toFixed(0);
  
  tr.innerHTML = `
    <td><strong>${sprintLabels[i]}</strong></td>
    <td>${totalIssues[i]}</td>
    <td>${doneCount[i]}</td>
    <td style="color:${rateColor};font-weight:600">${rate}%</td>
    <td>${avgCT[i]}d</td>
    <td>${medianCT[i]}d</td>
    <td>${p85CT[i]}d</td>
    <td style="width:160px">
      <div class="status-bar">
        <div style="width:${donePct}%;background:var(--green)" title="Done ${donePct}%"></div>
        ${inProg > 0 ? `<div style="width:${ipPct}%;background:var(--accent)" title="Active ${ipPct}%"></div>` : ''}
      </div>
    </td>
  `;
  tbody.appendChild(tr);
}

document.getElementById('genDate').textContent = new Date().toLocaleDateString();
</script>
</body>
</html>
